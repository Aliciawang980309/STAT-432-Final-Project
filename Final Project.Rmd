---
title: "Final Project"
author: "Hao Wang"
date: "12/10/2019"
output: html_document
---

## Introduction

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

```{r}
library(dplyr)
library(caret)
library(purrr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(tidyverse)
```

```{r}
bank = read.csv("bank-additional.csv")
```

```{r}
bank_full = read.csv("bank-additional-full.csv")
table(bank_full$job)
table(bank_full$education == "unknown")
table(bank_full$marital  == "unknown")
table(bank_full$default  == "unknown")
table(bank_full$housing  == "unknown")
table(bank_full$loan  == "unknown")
table(bank_full$y)
```

```{r}
bank_new = bank_full %>% 
  filter(bank_full$job != "unknown" & bank_full$marital != "unknown" & bank_full$education != "unknown" & bank_full$loan != "unknown" & bank_full$housing != "unknown")
```

```{r}
set.seed(42)
idx = createDataPartition(bank_new$y, p = 0.8, list = FALSE)
bank_trn = bank_new[idx, ]
bank_tst = bank_new[-idx, ]
```

```{r}
#names(bank_trn)
plot_1 = bank_new %>%
  ggplot(aes(x = age, col = job)) + 
  geom_density()

plot_2 = bank_new %>%
  ggplot(aes(x = education, fill = education)) + 
  geom_bar() + 
  facet_wrap(~housing)

plot_3 = bank_new %>%
  ggplot(aes(x = duration, y = education, color = y)) + 
  geom_point()
```

```{r, print-eda-plots, fig.height = 10, fig.width = 17}
gridExtra::grid.arrange(plot_1, plot_2, plot_3)
```